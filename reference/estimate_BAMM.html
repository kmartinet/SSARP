<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get tip speciation rates from BAMM (Rabosky 2014) analysis — estimate_BAMM • ssarp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get tip speciation rates from BAMM (Rabosky 2014) analysis — estimate_BAMM"><meta name="description" content="Use the BAMMtools package (Rabosky et al. 2014) to extract tip speciation
rates from user-supplied BAMM analysis objects."><meta property="og:description" content="Use the BAMMtools package (Rabosky et al. 2014) to extract tip speciation
rates from user-supplied BAMM analysis objects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ssarp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Get_Data.html">Get Occurrence Records from GBIF</a></li>
    <li><a class="dropdown-item" href="../articles/Create_SAR.html">Create Species-Area Relationship</a></li>
    <li><a class="dropdown-item" href="../articles/Create_SpAR.html">Create Speciation-Area Relationship</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kmartinet/ssarp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get tip speciation rates from BAMM (Rabosky 2014) analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/kmartinet/ssarp/blob/main/R/estimate_BAMM.R" class="external-link"><code>R/estimate_BAMM.R</code></a></small>
      <div class="d-none name"><code>estimate_BAMM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use the BAMMtools package (Rabosky et al. 2014) to extract tip speciation
rates from user-supplied BAMM analysis objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_BAMM</span><span class="op">(</span>label_type <span class="op">=</span> <span class="st">"binomial"</span>, <span class="va">occurrences</span>, <span class="va">edata</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-label-type">label_type<a class="anchor" aria-label="anchor" href="#arg-label-type"></a></dt>
<dd><p>Either "epithet" or "binomial" (default): describes the
type of tip label in the tree used for the BAMM analysis. If "epithet," only
the species epithet will be used to match speciation rates to tips in the
returned occurrence dataframe. If "binomial," the full species name
(including genus) will be used to match speciation rates to tips in the
returned occurrence dataframe.</p></dd>


<dt id="arg-occurrences">occurrences<a class="anchor" aria-label="anchor" href="#arg-occurrences"></a></dt>
<dd><p>The occurrence record dataframe output from the ssarp
pipeline. If you would like to use a custom dataframe, please make sure that
there are columns titled "genericName" and "specificEpithet"</p></dd>


<dt id="arg-edata">edata<a class="anchor" aria-label="anchor" href="#arg-edata"></a></dt>
<dd><p>The eventdata object created by using the
<code><a href="https://rdrr.io/pkg/BAMMtools/man/getEventData.html" class="external-link">BAMMtools::getEventData()</a></code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe that includes speciation rates for each species in the
occurrence record dataframe</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Rabosky, D.L. (2014). Automatic Detection of Key Innovations, Rate Shifts,
and Diversity-Dependence on Phylogenetic Trees. PLOS ONE, 9(2): e89543.</p></li>
<li><p>Rabosky, D.L., Grundler, M., Anderson, C., Title, P., Shi, J.J.,
Brown, J.W., Huang, H., &amp; Larson, J.G. (2014), BAMMtools: an R package for
the analysis of evolutionary dynamics on phylogenetic trees. Methods in
Ecology and Evolution, 5: 701-707.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The GBIF key for the Anolis genus is 8782549</span></span></span>
<span class="r-in"><span><span class="co"># Read in example dataset filtered from:</span></span></span>
<span class="r-in"><span><span class="co">#  dat &lt;- rgbif::occ_search(taxonKey = 8782549, </span></span></span>
<span class="r-in"><span><span class="co">#                           hasCoordinate = TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                           limit = 10000)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"ssarp_Example_Dat.csv"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"ssarp"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>file("") only supports open = "w+" and open = "w+b": using the former</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in read.table(file = file, header = header, sep = sep, quote = quote,     dec = dec, fill = fill, comment.char = comment.char, ...):</span> no lines available in input</span>
<span class="r-in"><span><span class="va">land</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_land.html">find_land</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'dat' not found</span>
<span class="r-in"><span><span class="va">areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_areas.html">find_areas</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">land</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'land' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read tree from Patton et al. (2021), trimmed to Caribbean species</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                             <span class="st">"Patton_Anolis_trimmed.tree"</span>,</span></span>
<span class="r-in"><span>                             package <span class="op">=</span> <span class="st">"ssarp"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>empty character string.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Event data file from an external BAMM run</span></span></span>
<span class="r-in"><span><span class="va">event_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"event_data_Patton_Anolis.txt"</span>,</span></span>
<span class="r-in"><span>                           package <span class="op">=</span> <span class="st">"ssarp"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           </span></span>
<span class="r-in"><span><span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu">BAMMtools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BAMMtools/man/getEventData.html" class="external-link">getEventData</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">tree</span>, eventdata <span class="op">=</span> <span class="va">event_data</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in tabulate(phy$edge, n + m):</span> 'bin' must be numeric or a factor</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">occ_speciation</span> <span class="op">&lt;-</span> <span class="fu">estimate_BAMM</span><span class="op">(</span>label_type <span class="op">=</span> <span class="st">"epithet"</span>,</span></span>
<span class="r-in"><span>                                 occurrences <span class="op">=</span> <span class="va">areas</span> ,</span></span>
<span class="r-in"><span>                                 edata <span class="op">=</span> <span class="va">edata</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'areas' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristen Martinet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

