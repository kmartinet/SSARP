<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get speciation rates using the DR statistic (Jetz et al. 2012) — estimate_DR • SSARP</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get speciation rates using the DR statistic (Jetz et al. 2012) — estimate_DR"><meta name="description" content="Use methodology from Sun and Folk (2020) to calculate the DR statistic for
each tip of a given tree and output a dataframe for use in SSARP's
speciation-area relationship pipeline. This method also removes any species
rows without rates (this is most likely to occur when the tree does not have
all of the species included in the occurrence record dataframe). The tree
read in the examples below is modified from Patton et al. (2021)."><meta property="og:description" content="Use methodology from Sun and Folk (2020) to calculate the DR statistic for
each tip of a given tree and output a dataframe for use in SSARP's
speciation-area relationship pipeline. This method also removes any species
rows without rates (this is most likely to occur when the tree does not have
all of the species included in the occurrence record dataframe). The tree
read in the examples below is modified from Patton et al. (2021)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SSARP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Create_SAR.html">Create Species-Area Relationship</a></li>
    <li><a class="dropdown-item" href="../articles/Create_SpAR.html">Create Speciation-Area Relationship</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kmartinet/SSARP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get speciation rates using the DR statistic (Jetz et al. 2012)</h1>
      <small class="dont-index">Source: <a href="https://github.com/kmartinet/SSARP/blob/main/R/estimate_DR.R" class="external-link"><code>R/estimate_DR.R</code></a></small>
      <div class="d-none name"><code>estimate_DR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use methodology from Sun and Folk (2020) to calculate the DR statistic for
each tip of a given tree and output a dataframe for use in SSARP's
speciation-area relationship pipeline. This method also removes any species
rows without rates (this is most likely to occur when the tree does not have
all of the species included in the occurrence record dataframe). The tree
read in the examples below is modified from Patton et al. (2021).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_DR</span><span class="op">(</span><span class="va">tree</span>, label_type <span class="op">=</span> <span class="st">"binomial"</span>, <span class="va">occurrences</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>The dated phylogenetic tree that corresponds with the taxa to be
included in a speciation-area relationship</p></dd>


<dt id="arg-label-type">label_type<a class="anchor" aria-label="anchor" href="#arg-label-type"></a></dt>
<dd><p>Either "epithet" or "binomial" (default): describes the
type of tip label in the provided tree. If "epithet," only the species
epithet will be used to match speciation rates to tips in the returned
occurrence dataframe. If "binomial," the full species name (including genus)
will be used to match speciation rates to tips in the returned occurrence
dataframe.</p></dd>


<dt id="arg-occurrences">occurrences<a class="anchor" aria-label="anchor" href="#arg-occurrences"></a></dt>
<dd><p>The occurrence record dataframe output from the SSARP
pipeline. If you would like to use a custom dataframe, please make sure that
there are columns titled "Genus" and "Species"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe that includes speciation rates for each species in the
occurrence record dataframe</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Jetz, W., Thomas, G.H, Joy, J.B., Harmann, K., &amp; Mooers, A.O. (2012). The
global diversity of birds in space and time. Nature, 491: 444-448.</p></li>
<li><p>Patton, A.H., Harmon, L.J., del Rosario Castañeda, M.,
Frank, H.K., Donihue, C.M., Herrel, A., &amp; Losos, J.B. (2021). When adaptive
radiations collide: Different evolutionary trajectories between and within
island and mainland lizard clades. PNAS, 118(42): e2024451118.</p></li>
<li><p>Sun, M. &amp; Folk, R.A. (2020). Cactusolo/rosid_NCOMMS-19-37964-T: Code and
data for rosid_NCOMMS-19-37964 (Version V.1.0). Zenodo.
http://doi.org/10.5281/zenodo.3843441</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The GBIF key for the Anolis genus is 8782549</span></span></span>
<span class="r-in"><span><span class="co">#  Obtained with: key &lt;- get_key(query = "Anolis", rank = "genus")</span></span></span>
<span class="r-in"><span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fl">8782549</span></span></span>
<span class="r-in"><span><span class="co"># Read in example dataset obtained through:</span></span></span>
<span class="r-in"><span><span class="co">#  dat &lt;- get_data(key = key, limit = 100)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"SSARP_Example_Dat.csv"</span>,</span></span>
<span class="r-in"><span>                            package <span class="op">=</span> <span class="st">"SSARP"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">land</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_land.html">find_land</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">areas</span> <span class="op">&lt;-</span> <span class="fu"><a href="find_areas.html">find_areas</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">land</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Recording island names...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Assembling island dictionary...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Adding areas to final dataframe...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read tree from Patton et al. (2021), trimmed to Caribbean species</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, </span></span>
<span class="r-in"><span>                                   <span class="st">"Patton_Anolis_trimmed.tree"</span>, </span></span>
<span class="r-in"><span>                                   package <span class="op">=</span> <span class="st">"SSARP"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>empty character string.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">occ_speciation</span> <span class="op">&lt;-</span> <span class="fu">estimate_DR</span><span class="op">(</span>tree <span class="op">=</span> <span class="va">tree</span>, </span></span>
<span class="r-in"><span>                              label_type <span class="op">=</span> <span class="st">"epithet"</span>, </span></span>
<span class="r-in"><span>                              occurrences <span class="op">=</span> <span class="va">areas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristen Martinet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

