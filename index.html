<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SSARP (Species-/Speciation-Area Relationship Projector) • SSARP</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="SSARP (Species-/Speciation-Area Relationship Projector)">
<meta name="description" content="Create Species- and Speciation-Area Relationships for any taxa.">
<meta property="og:description" content="Create Species- and Speciation-Area Relationships for any taxa.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SSARP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Create_SAR.html">Create Species-Area Relationship</a></li>
    <li><a class="dropdown-item" href="articles/Create_SpAR.html">Create Speciation-Area Relationship</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kmartinet/SSARP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ssarp">SSARP<a class="anchor" aria-label="anchor" href="#ssarp"></a>
</h1></div>
<!-- badges: start -->

<p>SSARP (Species-/Speciation-Area Relationship Projector) is an R package that provides a suite of functions to help users <strong>create speciation- and species-area relationships for island-dwelling taxa</strong> using occurrence data from GBIF (Global Biodiversity Information Facility) accessed via GBIF’s API or the user’s own occurrence data.</p>
<p>Species- and speciation-area relationships are useful for determining whether biodiversity is distributed in an unusual way in a given island system (e.g., species richness decreasing as islands get larger instead of increasing). An unusual trend in these relationships may be indicative of habitat loss or a negative impact of non-native species.</p>
<p>Please find the <a href="https://www.biorxiv.org/content/10.1101/2024.12.31.630948v1" class="external-link">bioRxiv preprint of the manuscript associated with <em>SSARP</em> here!</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install <em>SSARP</em>, use the “install_github” function from the <em>devtools</em> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kmartinet/SSARP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-creating-a-species-area-relationship">Example: Creating a Species-Area Relationship<a class="anchor" aria-label="anchor" href="#example-creating-a-species-area-relationship"></a>
</h2>
<p>A species-area relationship (SAR) visualizes the relationship between species richness (the number of species) and the area of the land mass on which the species live. This brief example covers the <em>SSARP</em> workflow for creating a SAR, and more detailed explanations of the code and methods can be found <a href="https://kmartinet.github.io/SSARP/index.html">in the Articles on the SSARP pkgdown website</a>.</p>
<p>In order to construct a species-area relationship with <em>SSARP</em>, we will:</p>
<ul>
<li>Gather occurrence data from GBIF</li>
<li>Filter out invalid occurrence records</li>
<li>Find areas of pertinent land masses</li>
<li>Create a species-area relationship</li>
</ul>
<div class="section level4">
<h4 id="step-1-gather-occurrence-data-from-gbif">Step 1: Gather occurrence data from GBIF<a class="anchor" aria-label="anchor" href="#step-1-gather-occurrence-data-from-gbif"></a>
</h4>
<p>In this step, we will find the unique identifying key associated with a taxon of interest (the lizard genus <em>Anolis</em> in this case) and use that key to access occurrence points for that taxon from GBIF. We will restrict the returned occurrence records to the Caribbean islands using the “geometry” parameter in the “getData” function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kmartinet/SSARP" class="external-link">SSARP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the GBIF key for the Anolis genus</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu">getKey</span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Anolis"</span>, rank <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the key</span></span>
<span><span class="va">key</span></span>
<span><span class="co">#&gt; [1] 8782549</span></span></code></pre></div>
<p>The GBIF key for <em>Anolis</em> is 8782549. We will use this key, along with a Well-Known Text (WKT) polygon around Caribbean islands, to get data for <em>Anolis</em> from GBIF using the “getData” function from <em>SSARP</em>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Get data for Anolis from GBIF in a specified polygon around Caribbean islands</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">getData</span><span class="op">(</span>key <span class="op">=</span> <span class="va">key</span>, limit <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  geometry <span class="op">=</span> <span class="st">'POLYGON((-84.8 23.9, -84.7 16.4, -65.2 13.9, -63.1 11.0, -56.9 15.5, -60.5 21.9, -79.3 27.8, -79.8 24.8, -84.8 23.9))'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the first 5 lines of dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 156</span></span>
<span><span class="co">#&gt;   key        scientificName   decimalLatitude decimalLongitude issues datasetKey</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     </span></span>
<span><span class="co">#&gt; 1 5007064248 Anolis distichu…            19.0            -69.0 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 2 5007082681 Anolis evermann…            18.3            -66.3 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 3 5007565800 Anolis cristate…            18.4            -66.0 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 4 5008127474 Anolis sagrei D…            18.4            -64.5 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; 5 5037019266 Anolis leachii …            17.1            -61.8 cdc,c… 50c9509d-…</span></span>
<span><span class="co">#&gt; # ℹ 150 more variables: publishingOrgKey &lt;chr&gt;, installationKey &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   hostingOrganizationKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   lastCrawled &lt;chr&gt;, lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, basisOfRecord &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   classKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;, speciesKey &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   acceptedTaxonKey &lt;int&gt;, acceptedScientificName &lt;chr&gt;, kingdom &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   phylum &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;, …</span></span></code></pre></div>
<p>The “dat” dataframe above includes the first 10,000 records from GBIF for <em>Anolis</em> within a specified polygon around the Caribbean islands.</p>
</div>
<div class="section level4">
<h4 id="step-2-filter-out-invalid-occurrence-records">Step 2: Filter out invalid occurrence records<a class="anchor" aria-label="anchor" href="#step-2-filter-out-invalid-occurrence-records"></a>
</h4>
<p>Now that we have a dataframe that includes the first 10,000 records for <em>Anolis</em> within a specified polygon around the Caribbean islands, we will filter that data to include only occurrence records that are on land. Some occurrence records might have GPS points that are in the ocean instead of on an island, so it is important to exclude these invalid records.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Find land mass names and exclude records not on land</span></span>
<span><span class="va">land_dat</span> <span class="op">&lt;-</span> <span class="fu">findLand</span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print first 5 lines of land_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">land_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                  SpeciesName  Genus      Species  Longitude</span></span>
<span><span class="co">#&gt; 1                Anolis distichus Cope, 1861 Anolis    distichus -69.010239</span></span>
<span><span class="co">#&gt; 2           Anolis evermanni Stejneger, 1904 Anolis    evermanni -66.314592</span></span>
<span><span class="co">#&gt; 3 Anolis cristatellus Duméril &amp; Bibron, 1837 Anolis cristatellus -65.957558</span></span>
<span><span class="co">#&gt; 4       Anolis sagrei Duméril &amp; Bibron, 1837 Anolis       sagrei -64.512895</span></span>
<span><span class="co">#&gt; 5      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.847698</span></span>
<span><span class="co">#&gt;    Latitude       First Second Third                           datasetKey</span></span>
<span><span class="co">#&gt; 1 19.015033        &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 2  18.29657 Puerto Rico   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 3 18.396785 Puerto Rico   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 4 18.384578        &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 5 17.118499     Antigua   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span></code></pre></div>
<p>The “land_dat” dataframe above is a filtered version of the “dat” dataframe that we created by gathering data from GBIF. The “land_dat” dataframe includes occurrence records with GPS points that fall on a land mass, along with the locality information for that land mass.</p>
<p>The locality information is split across three columns: “First,” “Second,” and “Third.” The mapping utilities that <em>SSARP</em> uses sometimes output different levels of specificity for locality information (up to three different levels), so these columns provide space for these different levels. The island name that we are interested in will be in the last filled-in column of the three. For example, if there are two columns of locality information for a given occurrence record, the island name will be in the second. If there is only one column of locality information, it will contain the island name (as with Puerto Rico and Antigua above). If all columns have NA, the occurrence record is invalid and will be filtered out in the next step.</p>
</div>
<div class="section level4">
<h4 id="step-3-find-areas-of-pertinent-land-masses">Step 3: Find areas of pertinent land masses<a class="anchor" aria-label="anchor" href="#step-3-find-areas-of-pertinent-land-masses"></a>
</h4>
<p>Next, we will use the dataframe of occurrence records with their associated land mass names (the “land_dat” object created above) with the “findAreas” function to find the area of each land mass.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Use the land mass names to get their areas</span></span>
<span><span class="va">area_dat</span> <span class="op">&lt;-</span> <span class="fu">findAreas</span><span class="op">(</span>occs <span class="op">=</span> <span class="va">land_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the first 5 lines of area_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">area_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                  SpeciesName  Genus      Species  Longitude</span></span>
<span><span class="co">#&gt; 2           Anolis evermanni Stejneger, 1904 Anolis    evermanni -66.314592</span></span>
<span><span class="co">#&gt; 3 Anolis cristatellus Duméril &amp; Bibron, 1837 Anolis cristatellus -65.957558</span></span>
<span><span class="co">#&gt; 5      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.847698</span></span>
<span><span class="co">#&gt; 6      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.845561</span></span>
<span><span class="co">#&gt; 7                  Anolis grahami Gray, 1845 Anolis      grahami -77.060327</span></span>
<span><span class="co">#&gt;    Latitude       First Second Third                           datasetKey</span></span>
<span><span class="co">#&gt; 2  18.29657 Puerto Rico   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 3 18.396785 Puerto Rico   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 5 17.118499     Antigua   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 6 17.121707     Antigua   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt; 7  18.39293     Jamaica   &lt;NA&gt;  &lt;NA&gt; 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">#&gt;         areas</span></span>
<span><span class="co">#&gt; 2  9710687500</span></span>
<span><span class="co">#&gt; 3  9710687500</span></span>
<span><span class="co">#&gt; 5   301187500</span></span>
<span><span class="co">#&gt; 6   301187500</span></span>
<span><span class="co">#&gt; 7 12225750000</span></span></code></pre></div>
<p>The “area_dat” dataframe includes records with GPS points that are associated with a land mass, along with the areas of those land masses (in m^2).</p>
</div>
<div class="section level4">
<h4 id="step-4-create-the-species-area-relationship">Step 4: Create the species-area relationship<a class="anchor" aria-label="anchor" href="#step-4-create-the-species-area-relationship"></a>
</h4>
<p>Finally, we will generate the SAR using the “SARP” function. The “SARP” function creates multiple regression objects with breakpoints up to the user-specified “npsi” parameter. For example, if “npsi” is two, “SARP” will generate regression objects with zero (linear regression), one, and two breakpoints. The function will then return the regression object with the lowest AIC score. The “npsi” parameter will be set to one in this example. Note that if linear regression (zero breakpoints) is better-supported than segmented regression with one breakpoint, the linear regression will be returned instead.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">SARP</span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">area_dat</span>, npsi <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;  ***Regression Model with Segmented Relationship(s)***</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Call: </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; segmented.lm(obj = linear, seg.Z = ~x, npsi = 1, control = seg.control(display = FALSE))</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; Estimated Break-Point(s):</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;           Est. St.Err</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; psi1.x 22.021  0.712</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; Coefficients of the linear terms:</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.96715    0.99558  -0.971   0.3382  </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; x            0.09202    0.05340   1.723   0.0939 .</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; U1.x         0.70904    0.21351   3.321       NA  </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.5596 on 34 degrees of freedom</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.6515,  Adjusted R-squared: 0.6207 </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; Boot restarting based on 6 samples. Last fit:</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; Convergence attained in 2 iterations (rel. change 1.0388e-09)</span></span></code></pre></div>
<p>This is the species-area relationship (SAR) for Anolis including island-based occurrences within a polygon around Caribbean islands from the first 10,000 records for the genus in GBIF! The best-fit model was a segmented regression with one breakpoint. The R console will also output statistical information about the model.</p>
</div>
<div class="section level3">
<h3 id="workflow-summary-for-using-data-from-gbif-to-create-a-species-area-relationship-plot">Workflow Summary for using data from GBIF to create a species-area relationship plot<a class="anchor" aria-label="anchor" href="#workflow-summary-for-using-data-from-gbif-to-create-a-species-area-relationship-plot"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use <code>getKey(query, rank)</code> to find the unique identifying key associated with your taxon of interest.<br>
</li>
<li>Use <code>getData(key, limit, geometry)</code> with the key found in Step 1 to access <em>limit</em> occurrence points from GBIF. There is a hard limit of 100,000 records for each call to <code>getData()</code>, as set by <a href="https://www.gbif.org/tool/81747/rgbif" class="external-link"><em>rgbif</em></a>. The “geometry” parameter can be specified with a well-known text (WKT) representation of of geometry to restrict the geographic location of the returned occurrence records (see more about WKT below).</li>
<li>Use <code>findLand(occ, fillgaps)</code> with the dataframe obtained in Step 2 to figure out the names of landmasses using the occurrence record GPS points and the <a href="https://cran.r-project.org/web/packages/maps/index.html" class="external-link"><em>maps</em> R package</a>. Setting the “fillgaps” parameter to <code>TRUE</code> will enable the use of <a href="https://photon.komoot.io/" class="external-link">Photon API</a> to fill in any missing landmass names left by the <em>maps</em> R package.</li>
<li>Use <code>findAreas(occ, area_custom)</code> with the dataframe obtained in Step 3 to match the landmass names to a dataset that includes names of most islands on the planet and their areas. If the user would like to use a custom island area dataset instead of the built-in one, the “area_custom” parameter can be set to the name of the custom island area dataframe. 4a. If you’d like to only include occurrence records from islands, you can remove continental records by using <code>removeContinents(occ)</code> with the dataframe returned by <code>findAreas()</code>
</li>
<li>Use <code>SARP(occ, npsi)</code> with the dataframe obtained in Step 4 to create a species-area relationship plot that reports information important to the associated regression. The “npsi” parameter indicates the maximum number of breakpoints the user would like to compare for model selection. The returned model and plot correspond with the best-fit model.</li>
</ol>
</div>
<div class="section level3">
<h3 id="workflow-summary-for-using-data-from-gbif-and-a-user-provided-phylogenetic-tree-to-create-a-speciation-area-relationship-plot">Workflow summary for using data from GBIF and a user-provided phylogenetic tree to create a speciation-area relationship plot<a class="anchor" aria-label="anchor" href="#workflow-summary-for-using-data-from-gbif-and-a-user-provided-phylogenetic-tree-to-create-a-speciation-area-relationship-plot"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Use <code>getKey(query, rank)</code> to find the unique identifying key associated with your taxon of interest.<br>
</li>
<li>Use <code>getData(key, limit, geometry)</code> with the key found in Step 1 to access <em>limit</em> occurrence points from GBIF. There is a hard limit of 100,000 records for each call to <code>getData()</code>, as set by <a href="https://www.gbif.org/tool/81747/rgbif" class="external-link"><em>rgbif</em></a>. The “geometry” parameter can be specified with a well-known text (WKT) representation of of geometry to restrict the geographic location of the returned occurrence records (see more about WKT below).</li>
<li>Use <code>findLand(occ, fillgaps)</code> with the dataframe obtained in Step 2 to figure out the names of landmasses using the occurrence record GPS points and the <a href="https://cran.r-project.org/web/packages/maps/index.html" class="external-link"><em>maps</em> R package</a>. Setting the “fillgaps” parameter to <code>TRUE</code> will enable the use of <a href="https://photon.komoot.io/" class="external-link">Photon API</a> to fill in any missing landmass names left by the <em>maps</em> R package.</li>
<li>Use <code>findAreas(occ, area_custom)</code> with the dataframe obtained in Step 3 to match the landmass names to a dataset that includes names of most islands on the planet and their areas. If the user would like to use a custom island area dataset instead of the built-in one, the “area_custom” parameter can be set to the name of the custom island area dataframe. 4a. If you’d like to only include occurrence records from islands, you can remove continental records by using <code>removeContinents(occ)</code> with the dataframe returned by <code>findAreas()</code>
</li>
<li>Use either <code>speciationDR(tree, label_type, occ)</code> or <code>speciationMS(tree, label_type, occ)</code> with your own phylogenetic tree that corresponds with the taxa signified in previous steps, a classifier that describes your tip labels (whether the tip labels are simply species epithets or full scientific names), and the dataframe obtained in Step 4 to add tip speciation rates using the DR statistic (Jetz et al. 2012) or the lambda calculation for crown groups from Magallόn and Sanderson (2001) respectively to the occurrence dataframe. The user may also choose to estimate tip speciation rates from a BAMM analysis (Rabosky 2014) by using <code>speciationBAMM(label_type, occ, edata)</code> with a classifier that describes your tip labels (whether the tip labels are simply species epithets or full scientific names), the occurrence record dataframe obtained in Step 4, and a bammdata object generated by reading the event data file from a BAMM analysis with the <em>BAMMtools</em> package (Rabosky et al. 2014).</li>
<li>Use <code>SpeARP(occ, npsi)</code> with the dataframe obtained in Step 5 to create a speciation-area relationship plot that reports information important to the associated regression. The “npsi” parameter indicates the maximum number of breakpoints the user would like to compare for model selection. The returned model and plot correspond with the best-fit model.</li>
</ol>
</div>
<div class="section level3">
<h3 id="some-helpful-notes-about-well-known-text-wkt-representation-of-geometry">Some helpful notes about well-known text (WKT) representation of geometry<a class="anchor" aria-label="anchor" href="#some-helpful-notes-about-well-known-text-wkt-representation-of-geometry"></a>
</h3>
<p>When running <code>getData()</code>, the user can specify a well-known text (WKT) representation of geometry to restrict the geographic location of the returned occurrence records. The rgbif::occ_search function that <code>getData()</code> calls requires a counter-clockwise winding order for WKT. I find it helpful to think about WKT polygons in this way: imagine a square around your geographic area of interest and pick one of the corners as a starting point. The order of points in WKT format should follow counter-clockwise from the corner you picked first, and the final entry in the WKT string needs to be the same as the first entry. Additionally, while GPS points are typically represented in “latitude, longitude” format, WKT expects them in “longitude latitude” format with commas separating the points rather than individual longitude and latitude values. WKT polygons can have more specified points than included in this simple square example, and even include polygons nested within others or polygons with holes in the middle.</p>
<div class="section level4">
<h4 id="literature-cited">Literature Cited<a class="anchor" aria-label="anchor" href="#literature-cited"></a>
</h4>
<ul>
<li>Jetz, W., Thomas, G.H, Joy, J.B., Harmann, K., &amp; Mooers, A.O. (2012). The global diversity of birds in space and time. <em>Nature</em>, 491: 444-448.</li>
<li>Magallόn, S. &amp; Sanderson, M.J. (2001). Absolute Diversification Rates in Angiosperm Clades. <em>Evolution</em>, 55(9): 1762-1780.</li>
<li>Rabosky, D.L. (2014). Automatic Detection of Key Innovations, Rate Shifts, and Diversity-Dependence on Phylogenetic Trees. PLOS ONE, 9(2): e89543.436</li>
<li>Rabosky, D.L., Grundler, M., Anderson, C., Title, P., Shi, J.J., Brown, J.W., Huang, H., &amp; Larson, J.G. (2014). BAMMtools: an R package for the analysis of evolutionary dynamics on phylogenetic trees. Methods in Ecology and Evolution, 5: 701-707.</li>
</ul>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kmartinet/SSARP/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kmartinet/SSARP/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SSARP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kristen Martinet <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/gh/kmartinet/SSARP?branch=main" class="external-link"><img src="https://codecov.io/gh/kmartinet/SSARP/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/kmartinet/SSARP/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kmartinet/SSARP/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/685" class="external-link"><img src="https://badges.ropensci.org/685_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristen Martinet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
