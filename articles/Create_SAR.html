<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Construct a Species-Area Relationship with SSARP • SSARP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Construct a Species-Area Relationship with SSARP">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SSARP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Create_SAR.html">Create Species-Area Relationship</a></li>
    <li><a class="dropdown-item" href="../articles/Create_SpAR.html">Create Speciation-Area Relationship</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kmartinet/SSARP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Construct a Species-Area Relationship with SSARP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kmartinet/SSARP/blob/main/vignettes/Create_SAR.Rmd" class="external-link"><code>vignettes/Create_SAR.Rmd</code></a></small>
      <div class="d-none name"><code>Create_SAR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A species-area relationship (SAR) visualizes the relationship between
species richness (the number of species) and the area of the land mass
on which the species live. The observation that species richness
increases with increasing area is a fundamental law of ecology, and a
disruption in this relationship may be associated with habitat loss,
habitat fragmentation, and increasing numbers of non-native species.
Creating SARs for island-dwelling species helps researchers understand
how trends in biodiversity across archipelagos are changing due to these
effects.</p>
<p>The goal of this vignette is to use the <em>SSARP</em> R package to
create a SAR for <em>Anolis</em>, a well-studied genus of lizards. We
will focus on <em>Anolis</em> occurrence records from the Caribbean
Islands. More information about the <em>SSARP</em> package and a
comparison to a previously published SAR for <em>Anolis</em> can be
found <a href="https://www.biorxiv.org/content/10.1101/2024.12.31.630948v1" class="external-link">in
the manuscript associated with the package</a>.</p>
<p>In order to construct a species-area relationship with
<em>SSARP</em>, we will:</p>
<ul>
<li>Gather occurrence data from GBIF</li>
<li>Filter out invalid occurrence records</li>
<li>Find areas of pertinent land masses</li>
<li>Create a species-area relationship</li>
</ul>
</div>
<div class="section level2">
<h2 id="gathering-occurrence-data">Gathering Occurrence Data<a class="anchor" aria-label="anchor" href="#gathering-occurrence-data"></a>
</h2>
<p>GBIF (Global Biodiversity Information Facility) provides an easy
method for gathering occurrence data for taxa of interest.
<em>SSARP</em> uses functions from the <em>rgbif</em> package to gather
occurrence records associated with a given taxon. The user may also
provide their own data for use in creating a SAR, but we will use GBIF
in this example.</p>
<p>In order to access data from GBIF, we must first determine the unique
identifying key associated with the taxon of interest. We will use the
<code><a href="../reference/get_key.html">SSARP::get_key()</a></code> function from <em>SSARP</em> to obtain
this key.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kmartinet/SSARP" class="external-link">SSARP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the GBIF key for the Anolis genus</span></span>
<span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_key.html">get_key</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Anolis"</span>, rank <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print key</span></span>
<span><span class="va">key</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8782549</span></span></code></pre>
<p>Now that we have the key associated with <em>Anolis</em>, we will use
this key with the <code><a href="../reference/get_data.html">SSARP::get_data()</a></code> function to gather
georeferenced occurrence records from GBIF. The “limit” parameter will
be set to 10000 in this case for a quick illustration of
<em>SSARP</em>’s functionality, but this parameter can be as large as
100,000 (the hard limit from <em>rgbif</em> for the number of records
returned).</p>
<p>We are only interested in occurrence records for island-dwelling
anole lizards located in the Caribbean, so we will geographically
restrict the returned data to this area by setting the “geometry”
parameter to a polygon in Well Known Text (WKT) format that encompasses
the Caribbean islands (Figure 1).</p>
<div class="float">
<img src="CaribbeanSpots_Final.png" alt="Figure 1. The GPS points associated with the WKT polygon in this example."><div class="figcaption">Figure 1. The GPS points associated with the WKT
polygon in this example.</div>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get data for Anolis from GBIF in the specified polygon</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">key</span>, limit <span class="op">=</span> <span class="fl">10000</span>, geometry <span class="op">=</span> <span class="st">'POLYGON((-84.8 23.9, -84.7 16.4, -65.2 13.9, -63.1 11.0, -56.9 15.5, -60.5 21.9, -79.3 27.8, -79.8 24.8, -84.8 23.9))'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print first 5 lines of dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 5 × 155</span></span>
<span><span class="co">##   key        scientificName        decimalLatitude decimalLongitude issues datasetKey publishingOrgKey installationKey</span></span>
<span><span class="co">##   &lt;chr&gt;      &lt;chr&gt;                           &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;          </span></span>
<span><span class="co">## 1 5007064248 Anolis distichus Cop…            19.0            -69.0 cdc,c… 50c9509d-… 28eb1a3f-1c15-4… 997448a8-f762-…</span></span>
<span><span class="co">## 2 5007082681 Anolis evermanni Ste…            18.3            -66.3 cdc,c… 50c9509d-… 28eb1a3f-1c15-4… 997448a8-f762-…</span></span>
<span><span class="co">## 3 5007565800 Anolis cristatellus …            18.4            -66.0 cdc,c… 50c9509d-… 28eb1a3f-1c15-4… 997448a8-f762-…</span></span>
<span><span class="co">## 4 5008127474 Anolis sagrei Duméri…            18.4            -64.5 cdc,c… 50c9509d-… 28eb1a3f-1c15-4… 997448a8-f762-…</span></span>
<span><span class="co">## 5 5037019266 Anolis leachii Dumér…            17.1            -61.8 cdc,c… 50c9509d-… 28eb1a3f-1c15-4… 997448a8-f762-…</span></span>
<span><span class="co">## # ℹ 147 more variables: hostingOrganizationKey &lt;chr&gt;, publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;, lastCrawled &lt;chr&gt;,</span></span>
<span><span class="co">## #   lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, basisOfRecord &lt;chr&gt;, occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;,</span></span>
<span><span class="co">## #   phylumKey &lt;int&gt;, classKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;, speciesKey &lt;int&gt;, acceptedTaxonKey &lt;int&gt;,</span></span>
<span><span class="co">## #   acceptedScientificName &lt;chr&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,</span></span>
<span><span class="co">## #   genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;, taxonomicStatus &lt;chr&gt;, iucnRedListCategory &lt;chr&gt;,</span></span>
<span><span class="co">## #   dateIdentified &lt;chr&gt;, coordinateUncertaintyInMeters &lt;dbl&gt;, continent &lt;chr&gt;, stateProvince &lt;chr&gt;, year &lt;int&gt;,</span></span>
<span><span class="co">## #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;chr&gt;, startDayOfYear &lt;int&gt;, endDayOfYear &lt;int&gt;, modified &lt;chr&gt;, …</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="finding-land-mass-names-and-areas">Finding Land Mass Names and Areas<a class="anchor" aria-label="anchor" href="#finding-land-mass-names-and-areas"></a>
</h2>
<p>Once the occurrence data is returned, we will use each occurrence
record’s GPS point to determine the land mass on which the species was
found and find the area associated with that land mass using a database
of island areas and names from <em>SSARP</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find land mass names</span></span>
<span><span class="va">land_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_land.html">find_land</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print first 5 lines of land_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">land_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                  SpeciesName  Genus      Species  Longitude  Latitude       First Second Third</span></span>
<span><span class="co">## 1                Anolis distichus Cope, 1861 Anolis    distichus -69.010239 19.015033        &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 2           Anolis evermanni Stejneger, 1904 Anolis    evermanni -66.314592  18.29657 Puerto Rico   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 3 Anolis cristatellus Duméril &amp; Bibron, 1837 Anolis cristatellus -65.957558 18.396785 Puerto Rico   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 4       Anolis sagrei Duméril &amp; Bibron, 1837 Anolis       sagrei -64.512895 18.384578        &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 5      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.847698 17.118499     Antigua   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">##                             datasetKey</span></span>
<span><span class="co">## 1 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">## 2 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">## 3 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">## 4 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span>
<span><span class="co">## 5 50c9509d-22c7-4a22-a47d-8c48425ef4a7</span></span></code></pre>
<p>The locality information is split across three columns: “First,”
“Second,” and “Third.” The mapping utilities that <em>SSARP</em> uses
sometimes output different levels of specificity for locality
information (up to three different levels), so these columns provide
space for these different levels. The island name that we are interested
in will be in the last filled-in column of the three. For example, if
there are two columns of locality information for a given occurrence
record, the island name will be in the second. If there is only one
column of locality information, it will contain the island name (as with
Puerto Rico and Antigua above). If all columns have <code>NA</code>, the
occurrence record is invalid and will be filtered out in the next
step.</p>
<p>Now that we have determined the names of the land masses associated
with each occurrence record, we will find the area associated with each
land mass.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the land mass names to get their areas</span></span>
<span><span class="va">area_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_areas.html">find_areas</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">land_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print first 5 lines of area_dat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">area_dat</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                  SpeciesName  Genus      Species  Longitude  Latitude       First Second Third</span></span>
<span><span class="co">## 2           Anolis evermanni Stejneger, 1904 Anolis    evermanni -66.314592  18.29657 Puerto Rico   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 3 Anolis cristatellus Duméril &amp; Bibron, 1837 Anolis cristatellus -65.957558 18.396785 Puerto Rico   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 5      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.847698 17.118499     Antigua   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 6      Anolis leachii Duméril &amp; Bibron, 1837 Anolis      leachii -61.845561 17.121707     Antigua   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">## 7                  Anolis grahami Gray, 1845 Anolis      grahami -77.060327  18.39293     Jamaica   &lt;NA&gt;  &lt;NA&gt;</span></span>
<span><span class="co">##                             datasetKey       areas</span></span>
<span><span class="co">## 2 50c9509d-22c7-4a22-a47d-8c48425ef4a7  9710687500</span></span>
<span><span class="co">## 3 50c9509d-22c7-4a22-a47d-8c48425ef4a7  9710687500</span></span>
<span><span class="co">## 5 50c9509d-22c7-4a22-a47d-8c48425ef4a7   301187500</span></span>
<span><span class="co">## 6 50c9509d-22c7-4a22-a47d-8c48425ef4a7   301187500</span></span>
<span><span class="co">## 7 50c9509d-22c7-4a22-a47d-8c48425ef4a7 12225750000</span></span></code></pre>
<p>Now, our occurrence record dataframe includes records with GPS points
that are associated with a land mass, along with the areas of those land
masses (in m^2).</p>
<p>The <code><a href="../reference/remove_continents.html">SSARP::remove_continents()</a></code> function removes any
continental occurrence records, which is useful when the user is only
interested in island-dwelling species (as we are in this example). While
the data obtained by using the <code><a href="../reference/get_data.html">SSARP::get_data()</a></code> function
was geographically restricted, potential user error in specifying the
polygon in WKT format often leads to accidental continental records that
will be removed by using this function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nocont_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_continents.html">remove_continents</a></span><span class="op">(</span>occs <span class="op">=</span> <span class="va">area_dat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-species-area-relationship">Create Species-Area Relationship<a class="anchor" aria-label="anchor" href="#create-species-area-relationship"></a>
</h2>
<p>Finally, we will generate the SAR using the
<code><a href="../reference/create_SAR.html">SSARP::create_SAR</a></code> function. The
<code><a href="../reference/create_SAR.html">SSARP::create_SAR()</a></code> function creates multiple regression
objects with breakpoints up to the user-specified “npsi” parameter. For
example, if “npsi” is two, <code><a href="../reference/create_SAR.html">SSARP::create_SAR()</a></code> will
generate regression objects with zero (linear regression), one, and two
breakpoints. The function will then return the regression object with
the lowest AIC score. The “npsi” parameter will be set to one in this
example. Note that if linear regression (zero breakpoints) is
better-supported than segmented regression with one breakpoint, the
linear regression will be returned instead.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_SAR.html">create_SAR</a></span><span class="op">(</span>occurrences <span class="op">=</span> <span class="va">nocont_dat</span>, npsi <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="anolis_SAR-1.png" alt="Figure 2. This is the species-area relationship (SAR) for Anolis including island-based occurrences within a polygon around Caribbean islands from the first 10000 records for the genus in GBIF! The best-fit model was a segmented regression with one breakpoint."><div class="figcaption">Figure 2. This is the species-area relationship
(SAR) for <em>Anolis</em> including island-based occurrences within a
polygon around Caribbean islands from the first 10000 records for the
genus in GBIF! The best-fit model was a segmented regression with one
breakpoint.</div>
</div>
<pre><code><span><span class="co">##  ***Regression Model with Segmented Relationship(s)***</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## segmented.lm(obj = linear, seg.Z = ~x, npsi = 1, control = seg.control(display = FALSE))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated Break-Point(s):</span></span>
<span><span class="co">##           Est. St.Err</span></span>
<span><span class="co">## psi1.x 21.977   0.75</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients of the linear terms:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept) -1.03529    1.00142  -1.034   0.3090  </span></span>
<span><span class="co">## x            0.09608    0.05355   1.794   0.0822 .</span></span>
<span><span class="co">## U1.x         0.67880    0.21273   3.191       NA  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.5573 on 32 degrees of freedom</span></span>
<span><span class="co">## Multiple R-Squared: 0.6611,  Adjusted R-squared: 0.6294 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Boot restarting based on 8 samples. Last fit:</span></span>
<span><span class="co">## Convergence attained in 2 iterations (rel. change 5.2078e-11)</span></span></code></pre>
<p>The <code><a href="../reference/create_SAR.html">SSARP::create_SAR()</a></code> function will also output the
summary for the best-fit model for the data (displayed above).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristen Martinet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
